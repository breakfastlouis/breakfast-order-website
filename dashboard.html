<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>è·¯æ˜“å£«æ—©é¤å§ï½œå¾Œå°ç®¡ç†</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@3.4.15/dist/vue.global.prod.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>body { font-family: 'Noto Sans TC', sans-serif; }</style>
</head>
<body class="bg-gray-50">
  <div id="app" class="p-6 max-w-6xl mx-auto">
    <h1 class="text-3xl font-bold text-blue-900 mb-6 text-center">è·¯æ˜“å£«æ—©é¤å§ï½œå¾Œå°ç®¡ç†</h1>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- èœå–®ç®¡ç†å€å¡Š -->
      <div>
        <h2 class="text-xl font-semibold text-blue-700 mb-4">ğŸ“‹ èœå–®ç®¡ç†</h2>

        <!-- æ–°å¢èœå–®è¡¨å–® -->
        <div class="mb-6">
          <h3 class="text-lg font-semibold text-gray-700 mb-2">â• æ–°å¢èœå–®å“é …</h3>
          <div class="space-y-2">
            <input v-model="newItem.id" type="text" placeholder="å“é …ç·¨è™Ÿï¼ˆå¦‚ A01ï¼‰"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300" />
            <input v-model="newItem.name" type="text" placeholder="å“é …åç¨±ï¼ˆå¦‚ ç«è…¿è›‹åå¸ï¼‰"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300" />
            <input v-model="newItem.price" type="number" placeholder="åƒ¹æ ¼ï¼ˆå¦‚ 45ï¼‰"
              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300" />
            <button @click="addMenuItem"
              class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded w-full">
              âœ… æ–°å¢å“é …
            </button>
          </div>
        </div>

        <div v-if="menu.length === 0" class="text-gray-500">å°šç„¡èœå–®è³‡æ–™</div>
        <ul>
          <li v-for="item in menu" :key="item.id" class="bg-white p-4 mb-3 rounded shadow flex justify-between items-center">
            <div>
              <div class="font-bold">{{ item.id }}. {{ item.name }}</div>
              <div class="text-sm text-gray-500">NT$ {{ item.price }}</div>
              <div class="text-xs text-gray-400">ç‹€æ…‹ï¼š{{ item.available ? 'ä¸Šæ¶ä¸­' : 'å·²ä¸‹æ¶' }}</div>
            </div>
            <div class="space-x-2">
              <button @click="toggleAvailable(item)" class="text-sm bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded">
                {{ item.available ? 'ä¸‹æ¶' : 'ä¸Šæ¶' }}
              </button>
              <button @click="deleteMenuItem(item)" class="text-sm bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded">
                åˆªé™¤
              </button>
            </div>
          </li>
        </ul>
      </div>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAEpf1ffQFht5yBm-xCBBMVsdxjzbVhsBg",
      authDomain: "louis-breakfast-tpe.firebaseapp.com",
      projectId: "louis-breakfast-tpe",
      storageBucket: "louis-breakfast-tpe.appspot.com",
      messagingSenderId: "707080689547",
      appId: "1:707080689547:web:ca293380046a59e7de818e",
      measurementId: "G-P4FXJC40KP"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const { createApp } = Vue;

    createApp({
      data() {
        return {
          menu: [],
          orders: [],
          newItem: {
            id: '',
            name: '',
            price: ''
          }
        };
      },
      computed: {
        sortedOrders() {
          return this.orders.slice().sort((a, b) => {
            const ta = a.createdAt?.seconds || 0;
            const tb = b.createdAt?.seconds || 0;
            return tb - ta;
          });
        }
      },
      methods: {
        addMenuItem() {
          const { id, name, price } = this.newItem;
          if (!id || !name || !price) {
            alert("è«‹å¡«å¯«å®Œæ•´å“é …è³‡è¨Š");
            return;
          }
          db.collection("menu").doc(id).set({
            id,
            name,
            price: Number(price),
            available: true
          }).then(() => {
            this.newItem = { id: '', name: '', price: '' };
          }).catch(err => {
            console.error("æ–°å¢å“é …å¤±æ•—", err);
            alert("æ–°å¢å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦");
          });
        },
        toggleAvailable(item) {
          db.collection("menu").doc(item.id).update({
            available: !item.available
          });
        },
        deleteMenuItem(item) {
          db.collection("menu").doc(item.id).delete();
        },
        markOrderComplete(order) {
          db.collection("orders").doc(order._docId).update({
            status: "å®Œæˆ"
          });
        },
        deleteOrder(order) {
          db.collection("orders").doc(order._docId).delete();
        }
      },
      mounted() {
        db.collection("menu").onSnapshot(snap => {
          this.menu = snap.docs.map(doc => {
            const data = doc.data();
            data.id = doc.id;
            return data;
          });
        });

        db.collection("orders").onSnapshot(snap => {
          this.orders = snap.docs.map(doc => {
            const data = doc.data();
            data._docId = doc.id;
            return data;
          });
        });
      }
    }).mount("#app");
  </script>
</body>
</html>
